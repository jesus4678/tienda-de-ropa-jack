import React, { useState, useEffect } from 'react';
import { ShoppingCart, Search, User, Menu, X, Plus, Minus, Star, Heart, Filter, Grid, List, Mail, Phone, MapPin, Facebook, Instagram, Twitter } from 'lucide-react';

const TiendaNarvaez = () => {
  const [currentView, setCurrentView] = useState('home');
  const [cart, setCart] = useState([]);
  const [favorites, setFavorites] = useState([]);
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('all');
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [viewMode, setViewMode] = useState('grid');
  const [sortBy, setSortBy] = useState('name');
  const [contactForm, setContactForm] = useState({
    name: '',
    email: '',
    message: ''
  });

  // Datos de productos
  const products = [
    {
      id: 1,
      name: 'Smartphone Samsung Galaxy A54',
      price: 899000,
      category: 'electronics',
      image: 'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400',
      rating: 4.5,
      stock: 15,
      description: 'Smartphone con c√°mara de 50MP, pantalla AMOLED de 6.4" y bater√≠a de larga duraci√≥n.'
    },
    {
      id: 2,
      name: 'Auriculares Sony WH-1000XM4',
      price: 650000,
      category: 'electronics',
      image: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400',
      rating: 4.8,
      stock: 8,
      description: 'Auriculares inal√°mbricos con cancelaci√≥n de ruido l√≠der en la industria.'
    },
    {
      id: 3,
      name: 'Camiseta Polo Cl√°sica',
      price: 89000,
      category: 'clothing',
      image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400',
      rating: 4.2,
      stock: 25,
      description: 'Camiseta polo 100% algod√≥n, disponible en varios colores.'
    },
    {
      id: 4,
      name: 'Zapatillas Deportivas Nike',
      price: 320000,
      category: 'shoes',
      image: 'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400',
      rating: 4.6,
      stock: 12,
      description: 'Zapatillas deportivas con tecnolog√≠a Air Max para m√°ximo confort.'
    },
    {
      id: 5,
      name: 'Laptop HP Pavilion 15',
      price: 2150000,
      category: 'electronics',
      image: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400',
      rating: 4.4,
      stock: 6,
      description: 'Laptop con procesador Intel i5, 8GB RAM, 512GB SSD.'
    },
    {
      id: 6,
      name: 'Reloj Casio Digital',
      price: 180000,
      category: 'accessories',
      image: 'https://images.unsplash.com/photo-1524805444758-089113d48a6d?w=400',
      rating: 4.3,
      stock: 20,
      description: 'Reloj digital resistente al agua con m√∫ltiples funciones.'
    }
  ];

  const categories = [
    { id: 'all', name: 'Todos los productos', icon: 'üõçÔ∏è' },
    { id: 'electronics', name: 'Electr√≥nicos', icon: 'üì±' },
    { id: 'clothing', name: 'Ropa', icon: 'üëï' },
    { id: 'shoes', name: 'Calzado', icon: 'üëü' },
    { id: 'accessories', name: 'Accesorios', icon: '‚åö' }
  ];

  // Funciones del carrito
  const addToCart = (product, quantity = 1) => {
    setCart(prevCart => {
      const existingItem = prevCart.find(item => item.id === product.id);
      if (existingItem) {
        return prevCart.map(item =>
          item.id === product.id
            ? { ...item, quantity: item.quantity + quantity }
            : item
        );
      }
      return [...prevCart, { ...product, quantity }];
    });
  };

  const removeFromCart = (productId) => {
    setCart(prevCart => prevCart.filter(item => item.id !== productId));
  };

  const updateQuantity = (productId, newQuantity) => {
    if (newQuantity === 0) {
      removeFromCart(productId);
    } else {
      setCart(prevCart =>
        prevCart.map(item =>
          item.id === productId ? { ...item, quantity: newQuantity } : item
        )
      );
    }
  };

  const toggleFavorite = (productId) => {
    setFavorites(prev =>
      prev.includes(productId)
        ? prev.filter(id => id !== productId)
        : [...prev, productId]
    );
  };

  // Filtros y b√∫squeda
  const filteredProducts = products.filter(product => {
    const matchesSearch = product.name.toLowerCase().includes(searchTerm.toLowerCase());
    const matchesCategory = selectedCategory === 'all' || product.category === selectedCategory;
    return matchesSearch && matchesCategory;
  }).sort((a, b) => {
    switch (sortBy) {
      case 'price-low': return a.price - b.price;
      case 'price-high': return b.price - a.price;
      case 'rating': return b.rating - a.rating;
      default: return a.name.localeCompare(b.name);
    }
  });

  const cartTotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
  const cartCount = cart.reduce((total, item) => total + item.quantity, 0);

  const handleContactSubmit = (e) => {
    e.preventDefault();
    alert('Mensaje enviado correctamente. Te contactaremos pronto.');
    setContactForm({ name: '', email: '', message: '' });
  };

  // Componentes
  const Header = () => (
    <header className="bg-gradient-to-r from-blue-900 to-purple-900 text-white shadow-lg sticky top-0 z-50">
      <div className="container mx-auto px-4">
        <div className="flex items-center justify-between py-4">
          <div className="flex items-center space-x-4">
            <button
              onClick={() => setIsMenuOpen(!isMenuOpen)}
              className="md:hidden"
            >
              {isMenuOpen ? <X size={24} /> : <Menu size={24} />}
            </button>
            <h1 className="text-2xl font-bold bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent">
              Tienda Narv√°ez
            </h1>
          </div>

          <nav className={`${isMenuOpen ? 'block' : 'hidden'} md:block absolute md:relative top-16 md:top-0 left-0 md:left-auto w-full md:w-auto bg-blue-900 md:bg-transparent z-40`}>
            <ul className="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-6 p-4 md:p-0">
              <li><button onClick={() => { setCurrentView('home'); setIsMenuOpen(false); }} className={`hover:text-yellow-400 transition-colors ${currentView === 'home' ? 'text-yellow-400' : ''}`}>Inicio</button></li>
              <li><button onClick={() => { setCurrentView('products'); setIsMenuOpen(false); }} className={`hover:text-yellow-400 transition-colors ${currentView === 'products' ? 'text-yellow-400' : ''}`}>Productos</button></li>
              <li><button onClick={() => { setCurrentView('contact'); setIsMenuOpen(false); }} className={`hover:text-yellow-400 transition-colors ${currentView === 'contact' ? 'text-yellow-400' : ''}`}>Contacto</button></li>
            </ul>
          </nav>

          <div className="flex items-center space-x-4">
            <button 
              onClick={() => setCurrentView('cart')}
              className="relative p-2 hover:bg-white/10 rounded-full transition-colors"
            >
              <ShoppingCart size={24} />
              {cartCount > 0 && (
                <span className="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">
                  {cartCount}
                </span>
              )}
            </button>
            <User size={24} className="cursor-pointer hover:text-yellow-400 transition-colors" />
          </div>
        </div>
      </div>
    </header>
  );

  const ProductCard = ({ product }) => (
    <div className="bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 overflow-hidden">
      <div className="relative">
        <img
          src={product.image}
          alt={product.name}
          className="w-full h-48 object-cover"
        />
        <button
          onClick={() => toggleFavorite(product.id)}
          className={`absolute top-2 right-2 p-2 rounded-full transition-colors ${
            favorites.includes(product.id)
              ? 'bg-red-500 text-white'
              : 'bg-white/80 text-gray-600 hover:bg-red-500 hover:text-white'
          }`}
        >
          <Heart size={16} fill={favorites.includes(product.id) ? 'currentColor' : 'none'} />
        </button>
        {product.stock < 10 && (
          <span className="absolute top-2 left-2 bg-orange-500 text-white px-2 py-1 rounded text-xs font-bold">
            ¬°√öltimos {product.stock}!
          </span>
        )}
      </div>
      
      <div className="p-4">
        <h3 className="font-semibold text-lg mb-2 line-clamp-2">{product.name}</h3>
        <p className="text-gray-600 text-sm mb-3 line-clamp-2">{product.description}</p>
        
        <div className="flex items-center mb-3">
          {[...Array(5)].map((_, i) => (
            <Star
              key={i}
              size={16}
              className={i < Math.floor(product.rating) ? 'text-yellow-400 fill-current' : 'text-gray-300'}
            />
          ))}
          <span className="ml-2 text-sm text-gray-600">({product.rating})</span>
        </div>
        
        <div className="flex items-center justify-between">
          <span className="text-2xl font-bold text-blue-600">
            ${product.price.toLocaleString()}
          </span>
          <button
            onClick={() => addToCart(product)}
            className="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 flex items-center space-x-1"
          >
            <Plus size={16} />
            <span>Agregar</span>
          </button>
        </div>
      </div>
    </div>
  );

  const HomePage = () => (
    <div className="min-h-screen">
      {/* Hero Section */}
      <section className="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white py-20">
        <div className="container mx-auto px-4 text-center">
          <h2 className="text-5xl font-bold mb-6">Bienvenido a Tienda Narv√°ez</h2>
          <p className="text-xl mb-8 max-w-2xl mx-auto">Descubre los mejores productos con la mejor calidad y precios incre√≠bles. Tu satisfacci√≥n es nuestra prioridad.</p>
          <button
            onClick={() => setCurrentView('products')}
            className="bg-white text-blue-600 px-8 py-3 rounded-full font-bold text-lg hover:bg-gray-100 transition-colors"
          >
            Ver Productos
          </button>
        </div>
      </section>

      {/* Categor√≠as Destacadas */}
      <section className="py-16 bg-gray-50">
        <div className="container mx-auto px-4">
          <h3 className="text-3xl font-bold text-center mb-12">Nuestras Categor√≠as</h3>
          <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
            {categories.slice(1).map(category => (
              <div
                key={category.id}
                onClick={() => {
                  setSelectedCategory(category.id);
                  setCurrentView('products');
                }}
                className="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center"
              >
                <div className="text-4xl mb-4">{category.icon}</div>
                <h4 className="font-semibold">{category.name}</h4>
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* Productos Destacados */}
      <section className="py-16">
        <div className="container mx-auto px-4">
          <h3 className="text-3xl font-bold text-center mb-12">Productos Destacados</h3>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {products.slice(0, 3).map(product => (
              <ProductCard key={product.id} product={product} />
            ))}
          </div>
        </div>
      </section>
    </div>
  );

  const ProductsPage = () => (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        {/* Barra de b√∫squeda y filtros */}
        <div className="bg-white p-6 rounded-lg shadow-md mb-8">
          <div className="flex flex-col lg:flex-row gap-4 items-center">
            <div className="relative flex-1">
              <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={20} />
              <input
                type="text"
                placeholder="Buscar productos..."
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
                className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              />
            </div>
            
            <select
              value={selectedCategory}
              onChange={(e) => setSelectedCategory(e.target.value)}
              className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
            >
              {categories.map(category => (
                <option key={category.id} value={category.id}>
                  {category.name}
                </option>
              ))}
            </select>

            <select
              value={sortBy}
              onChange={(e) => setSortBy(e.target.value)}
              className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
            >
              <option value="name">Nombre A-Z</option>
              <option value="price-low">Precio: Menor a Mayor</option>
              <option value="price-high">Precio: Mayor a Menor</option>
              <option value="rating">Mejor Calificaci√≥n</option>
            </select>

            <div className="flex items-center space-x-2">
              <button
                onClick={() => setViewMode('grid')}
                className={`p-2 rounded ${viewMode === 'grid' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
              >
                <Grid size={20} />
              </button>
              <button
                onClick={() => setViewMode('list')}
                className={`p-2 rounded ${viewMode === 'list' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
              >
                <List size={20} />
              </button>
            </div>
          </div>
        </div>

        {/* Lista de productos */}
        <div className={`grid gap-6 ${viewMode === 'grid' 
          ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4' 
          : 'grid-cols-1'
        }`}>
          {filteredProducts.map(product => (
            <ProductCard key={product.id} product={product} />
          ))}
        </div>

        {filteredProducts.length === 0 && (
          <div className="text-center py-16">
            <p className="text-xl text-gray-600">No se encontraron productos que coincidan con tu b√∫squeda.</p>
          </div>
        )}
      </div>
    </div>
  );

  const CartPage = () => (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        <h2 className="text-3xl font-bold mb-8">Carrito de Compras</h2>
        
        {cart.length === 0 ? (
          <div className="bg-white p-8 rounded-lg shadow-md text-center">
            <ShoppingCart size={64} className="mx-auto text-gray-400 mb-4" />
            <p className="text-xl text-gray-600 mb-4">Tu carrito est√° vac√≠o</p>
            <button
              onClick={() => setCurrentView('products')}
              className="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors"
            >
              Continuar Comprando
            </button>
          </div>
        ) : (
          <div className="grid lg:grid-cols-3 gap-8">
            <div className="lg:col-span-2">
              <div className="bg-white rounded-lg shadow-md overflow-hidden">
                {cart.map(item => (
                  <div key={item.id} className="flex items-center p-4 border-b border-gray-200">
                    <img
                      src={item.image}
                      alt={item.name}
                      className="w-20 h-20 object-cover rounded-lg mr-4"
                    />
                    <div className="flex-1">
                      <h3 className="font-semibold text-lg">{item.name}</h3>
                      <p className="text-gray-600">${item.price.toLocaleString()}</p>
                    </div>
                    <div className="flex items-center space-x-2">
                      <button
                        onClick={() => updateQuantity(item.id, item.quantity - 1)}
                        className="p-1 rounded-full bg-gray-200 hover:bg-gray-300"
                      >
                        <Minus size={16} />
                      </button>
                      <span className="w-8 text-center">{item.quantity}</span>
                      <button
                        onClick={() => updateQuantity(item.id, item.quantity + 1)}
                        className="p-1 rounded-full bg-gray-200 hover:bg-gray-300"
                      >
                        <Plus size={16} />
                      </button>
                    </div>
                    <button
                      onClick={() => removeFromCart(item.id)}
                      className="ml-4 text-red-500 hover:text-red-700"
                    >
                      <X size={20} />
                    </button>
                  </div>
                ))}
              </div>
            </div>
            
            <div className="bg-white p-6 rounded-lg shadow-md h-fit">
              <h3 className="text-xl font-bold mb-4">Resumen del Pedido</h3>
              <div className="space-y-2 mb-4">
                <div className="flex justify-between">
                  <span>Subtotal:</span>
                  <span>${cartTotal.toLocaleString()}</span>
                </div>
                <div className="flex justify-between">
                  <span>Env√≠o:</span>
                  <span>Gratis</span>
                </div>
                <div className="border-t pt-2">
                  <div className="flex justify-between font-bold text-lg">
                    <span>Total:</span>
                    <span>${cartTotal.toLocaleString()}</span>
                  </div>
                </div>
              </div>
              <button className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-lg font-bold hover:from-blue-600 hover:to-purple-700 transition-all">
                Proceder al Pago
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );

  const ContactPage = () => (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-8">
        <h2 className="text-3xl font-bold text-center mb-12">Cont√°ctanos</h2>
        
        <div className="grid md:grid-cols-2 gap-12">
          <div className="bg-white p-8 rounded-lg shadow-md">
            <h3 className="text-2xl font-bold mb-6">Env√≠anos un Mensaje</h3>
            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
                <input
                  type="text"
                  value={contactForm.name}
                  onChange={(e) => setContactForm({...contactForm, name: e.target.value})}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Tu nombre completo"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                <input
                  type="email"
                  value={contactForm.email}
                  onChange={(e) => setContactForm({...contactForm, email: e.target.value})}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="tu@email.com"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Mensaje</label>
                <textarea
                  rows={4}
                  value={contactForm.message}
                  onChange={(e) => setContactForm({...contactForm, message: e.target.value})}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  placeholder="Escribe tu mensaje aqu√≠..."
                />
              </div>
              <button
                onClick={handleContactSubmit}
                className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-2 rounded-lg font-bold hover:from-blue-600 hover:to-purple-700 transition-all"
              >
                Enviar Mensaje
              </button>
            </div>
          </div>
          
          <div className="space-y-8">
            <div className="bg-white p-6 rounded-lg shadow-md">
              <h3 className="text-xl font-bold mb-4">Informaci√≥n de Contacto</h3>
              <div className="space-y-4">
                <div className="flex items-center space-x-3">
                  <Phone className="text-blue-500" size={20} />
                  <span>+57 (2) 123-4567</span>
                </div>
                <div className="flex items-center space-x-3">
                  <Mail className="text-blue-500" size={20} />
                  <span>info@tiendanarvaez.com</span>
                </div>
                <div className="flex items-center space-x-3">
                  <MapPin className="text-blue-500" size={20} />
                  <span>Cali, Valle del Cauca, Colombia</span>
                </div>
              </div>
            </div>
            
            <div className="bg-white p-6 rounded-lg shadow-md">
              <h3 className="text-xl font-bold mb-4">S√≠guenos</h3>
              <div className="flex space-x-4">
                <Facebook className="text-blue-600 cursor-pointer hover:text-blue-700" size={24} />
                <Instagram className="text-pink-600 cursor-pointer hover:text-pink-700" size={24} />
                <Twitter className="text-blue-400 cursor-pointer hover:text-blue-500" size={24} />
              </div>
            </div>
            
            <div className="bg-white p-6 rounded-lg shadow-md">
              <h3 className="text-xl font-bold mb-4">Horarios de Atenci√≥n</h3>
              <div className="space-y-2">
                <div className="flex justify-between">
                  <span>Lunes - Viernes:</span>
                  <span>8:00 AM - 6:00 PM</span>
                </div>
                <div className="flex justify-between">
                  <span>S√°bados:</span>
                  <span>9:00 AM - 4:00 PM</span>
                </div>
                <div className="flex justify-between">
                  <span>Domingos:</span>
                  <span>Cerrado</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );

  const Footer = () => (
    <footer className="bg-gray-900 text-white py-12">
      <div className="container mx-auto px-4">
        <div className="grid md:grid-cols-4 gap-8">
          <div>
            <h3 className="text-xl font-bold mb-4">Tienda Narv√°ez</h3>
            <p className="text-gray-400">Tu tienda de confianza con los mejores productos y precios.</p>
          </div>
          <div>
            <h4 className="font-bold mb-4">Enlaces R√°pidos</h4>
            <ul className="space-y-2 text-gray-400">
              <li><button onClick={() => setCurrentView('home')} className="hover:text-white">Inicio</button></li>
              <li><button onClick={() => setCurrentView('products')} className="hover:text-white">Productos</button></li>
              <li><button onClick={() => setCurrentView('contact')} className="hover:text-white">Contacto</button></li>
            </ul>
          </div>
          <div>
            <h4 className="font-bold mb-4">Categor√≠as</h4>
            <ul className="space-y-2 text-gray-400">
              {categories.slice(1).map(category => (
                <li key={category.id}>
                  <button 
                    onClick={() => {
                      setSelectedCategory(category.id);
                      setCurrentView('products');
                    }}
                    className="hover:text-white"
                  >
                    {category.name}
                  </button>
                </li>
              ))}
            </ul>
          </div>
          <div>
            <h4 className="font-bold mb-4">Contacto</h4>
            <div className="space-y-2 text-gray-400">
              <p>üìû +57 (2) 123-4567</p>
              <p>‚úâÔ∏è info@tiendanarvaez.com</p>
              <p>üìç Cali, Valle del Cauca</p>
            </div>
          </div>
        </div>
        <div className="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>&copy; 2025 Tienda Narv√°ez. Todos los derechos reservados.</p>
        </div>
      </div>
    </footer>
  );

  return (
    <div className="min-h-screen bg-gray-100">
      <Header />
      
      {currentView === 'home' && <HomePage />}
      {currentView === 'products' && <ProductsPage />}
      {currentView === 'cart' && <CartPage />}
      {currentView === 'contact' && <ContactPage />}
      
      <Footer />
    </div>
  );
};